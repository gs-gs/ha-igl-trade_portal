<!doctype html>
<html lang="en" class="h-100">

{% load static %}

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>{% block head_title %}Trade Portal{% endblock %}</title>

    <link rel="icon" href="{% static 'images/favicon.png' %}">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    {% block extra_head %}{% endblock %}
  </head>

  <body class="d-flex flex-column {% block body_class %}{% endblock %}{% if request.user.is_authenticated %} authenticated{% endif %}">
    <header class="header {% block header_class %}{% endblock %}">
      <div class="header__container">
        <a class="header__logo" href="/">
          <img src="{% static 'images/logo.svg' %}" alt="Trade Portal" class="header__logo-image header__logo-image--default" />
          <img src="{% static 'images/logo-white.svg' %}" alt="Trade Portal" class="header__logo-image header__logo-image--white" />
          <span class="header__logo-text">Inter-Government Ledger Trade Portal</span>
        </a>
        <div class="header__nav">
          <div class="header__nav-actions">
            {% if request.user.is_authenticated %}
              <div class="header__user">
                <div class="header__user-name">{{ user }}</div>
                <div class="header__user-org">ACME Pty Ltd</div>
              </div>
            {% else %}
              <a href="/accounts/signup/" class="btn btn-primary header__nav-btn">Sign up</a>
              <a href="/accounts/login/" class="btn header__nav-btn header__nav-btn--mygovid">MyGovID</a>
            {% endif %}
            <button class="header__menu-toggler" type="button" data-toggle="collapse" data-target="#mainMenu" aria-controls="mainMenu" aria-expanded="false" aria-label="Toggle navigation">
              <span class="icon icon-menu"></span>
            </button>
          </div>
          <div class="site-nav__overlay"></div>
          <div class="collapse site-nav" id="mainMenu">
            <div class="site-nav__header">
              <button class="site-nav__close" type="button" data-toggle="collapse" data-target="#mainMenu" aria-controls="mainMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="icon icon-close"></span>
              </button>
            </div>
            <ul class="site-nav__list">
              <li class="site-nav__item"> {#  active #}
                <a class="site-nav__item-link" href="/">Home</a>
              </li>
              {% if not request.user.is_authenticated %}
                <li class="site-nav__item">
                  <a class="site-nav__item-link" href="/accounts/login/">Login</a>
                </li>
              {% else %}
                <li class="site-nav__item">
                  <a class="site-nav__item-link" href="{% url 'documents:list' %}">Documents</a>
                  {% if request.user.is_staff %}
                    <li class="site-nav__item">
                      <a class="site-nav__item-link" href="/admin/" target="_new">Admin Panel</a>
                    </li>
                  {% endif %}
                  <li class="site-nav__item">
                    <a class="site-nav__item-link" href="/profile/">{{ user }}</a>
                  </li>
                  <li class="site-nav__item">
                    <a class="site-nav__item-link" href="/logout/">Logout</a>
                  </li>
                </li>
              {% endif %}
              <li class="site-nav__org">
                <form class="form-inline" action="{% url 'users:change-org' %}?next={{ request.path_info }}" id='id-current-org-form' method="POST">
                  {% csrf_token %}
                  {% if user.orgs %}
                    <span>Acting as
                      <select class="form-control" onChange="$('#id-current-org-form').submit()" name="current_org">
                        {% for org in user.orgs %}
                          <option value="{{ org.pk }}" {% if org.id == current_org.id %}selected{% endif %}>{{ org }}</option>
                        {% endfor %}
                      </select>
                    </span>
                  {% else %}
                    {% if user.is_staff %}
                      <span style="color: white">Staff member</span>
                    {% endif %}
                  {% endif %}
                </form>
              </li>
            </ul>
          </div>
        </div>
      </div>
      {% if request.user.is_authenticated %}
      <div class="header__account-nav account-nav">
        <div class="account-nav__container">
          <ul class="account-nav__list">
            <li class="account-nav__item">
              <a class="account-nav__item-link{% if request.resolver_match.view_name == 'documents:list' %} active{% endif %}" href="{% url 'documents:list' %}">Documents</a>
            </li>
            <li class="account-nav__item">
              <a class="account-nav__item-link" href="/profile/">Profile</a>
            </li>
          </ul>
          <ul class="account-nav__list">
            <li class="account-nav__item">
              <a class="account-nav__item-link" href="/logout/">Logout</a>
            </li>
          </ul>
        </div>
      </div>
      {% endif %}
    </header>

    <!-- Begin page content -->
    <main role="main" class="page-main">
      <div class="{% block main-container %}container-fluid{% endblock %}">
        {% if messages %}
          {% for message in messages %}
            <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
              <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true" class="ml-3">&times;</span></button>
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}
        {% block content %}{% endblock %}
      </div>
    </main>

    <footer class="footer mt-auto">
      <div class="footer__logo">
        <img src="{% static 'images/footer-logo.png' %}" alt="">
      </div>
      <div class="footer-menu footer__menu">
        <ul class="footer-menu__list">
          <li class="footer-menu__item"><a href="#" class="footer-menu__item-link">Who we are</a></li>
          <li class="footer-menu__item"><a href="#" class="footer-menu__item-link">Our Ministers</a></li>
          <li class="footer-menu__item"><a href="#" class="footer-menu__item-link">Careers</a></li>
          <li class="footer-menu__item"><a href="/about/" class="footer-menu__item-link">About us</a></li>
          <li class="footer-menu__item"><a href="#" class="footer-menu__item-link">Contact us</a></li>
        </ul>
      </div>
      <div class="footer__copyright"><p class="footer__copyright-text">Copyright Department of Home Affairs &copy; 2020</p></div>
    </footer>
    <script src="{% static 'js/scripts.js' %}"></script>
    {% block extra_script %}{% endblock %}
  </body>
</html>
